/*! ðŸŒ¸ LOTUS GLASS - CORE JAVASCRIPT v6.0 | Essential Functions & Utilities | 2025 */
(function(window,document){'use strict';const PerfUtils={debounce:(func,wait)=>{let timeout;return function executedFunction(...args){const later=()=>{clearTimeout(timeout);func(...args);};clearTimeout(timeout);timeout=setTimeout(later,wait);}},throttle:(func,limit)=>{let inThrottle;return function(...args){if(!inThrottle){func.apply(this,args);inThrottle=true;setTimeout(()=>inThrottle=false,limit);}}},raf:(callback)=>{'requestAnimationFrame'in window?requestAnimationFrame(callback):setTimeout(callback,16)}};class OptimizedLazyLoader{constructor(){this.observer=null;this.init()}init(){if('IntersectionObserver'in window){this.observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){this.loadElement(entry.target);this.observer.unobserve(entry.target)}})},{rootMargin:'50px'});this.observeElements()}else{this.fallbackLoad()}}observeElements(){const lazyElements=document.querySelectorAll('[data-lazy-src], [data-lazy-bg]');lazyElements.forEach(el=>this.observer.observe(el))}loadElement(element){if(element.dataset.lazySrc){element.src=element.dataset.lazySrc;element.removeAttribute('data-lazy-src')}if(element.dataset.lazyBg){element.style.backgroundImage=`url(${element.dataset.lazyBg})`;element.removeAttribute('data-lazy-bg')}element.classList.add('loaded')}fallbackLoad(){const lazyElements=document.querySelectorAll('[data-lazy-src], [data-lazy-bg]');lazyElements.forEach(el=>this.loadElement(el))}}class DOMUtils{static ready(callback){if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',callback)}else{callback()}}static $(selector,context=document){return context.querySelector(selector)}static $$(selector,context=document){return Array.from(context.querySelectorAll(selector))}static create(tag,attributes={},content=''){const element=document.createElement(tag);Object.entries(attributes).forEach(([key,value])=>{if(key==='className'){element.className=value}else if(key==='innerHTML'){element.innerHTML=value}else{element.setAttribute(key,value)}});if(content)element.textContent=content;return element}static remove(element){if(element&&element.parentNode){element.parentNode.removeChild(element)}}static addClass(element,className){if(element){element.classList.add(className)}}static removeClass(element,className){if(element){element.classList.remove(className)}}static toggleClass(element,className){if(element){element.classList.toggle(className)}}static hasClass(element,className){return element?element.classList.contains(className):false}static on(element,event,handler,options={}){if(element){element.addEventListener(event,handler,options)}}static off(element,event,handler){if(element){element.removeEventListener(event,handler)}}static trigger(element,eventType,detail={}){if(element){const event=new CustomEvent(eventType,{detail,bubbles:true,cancelable:true});element.dispatchEvent(event)}}}class StorageUtils{static set(key,value,type='localStorage'){try{const storage=type==='sessionStorage'?sessionStorage:localStorage;storage.setItem(key,JSON.stringify(value));return true}catch(e){console.warn('Storage not available:',e);return false}}static get(key,defaultValue=null,type='localStorage'){try{const storage=type==='sessionStorage'?sessionStorage:localStorage;const item=storage.getItem(key);return item?JSON.parse(item):defaultValue}catch(e){console.warn('Storage not available:',e);return defaultValue}}static remove(key,type='localStorage'){try{const storage=type==='sessionStorage'?sessionStorage:localStorage;storage.removeItem(key);return true}catch(e){console.warn('Storage not available:',e);return false}}static clear(type='localStorage'){try{const storage=type==='sessionStorage'?sessionStorage:localStorage;storage.clear();return true}catch(e){console.warn('Storage not available:',e);return false}}}class EventBus{constructor(){this.events={}}on(event,callback){if(!this.events[event]){this.events[event]=[]}this.events[event].push(callback)}off(event,callback){if(this.events[event]){this.events[event]=this.events[event].filter(cb=>cb!==callback)}}emit(event,data){if(this.events[event]){this.events[event].forEach(callback=>callback(data))}}}class PerformanceMonitor{constructor(){this.metrics={};this.observers=[];this.init()}init(){if('PerformanceObserver'in window){this.observeNavigation();this.observePaint();this.observeResources()}}observeNavigation(){try{const observer=new PerformanceObserver((list)=>{const entries=list.getEntries();entries.forEach(entry=>{this.metrics.navigation={loadTime:entry.loadEventEnd-entry.loadEventStart,domContentLoaded:entry.domContentLoadedEventEnd-entry.domContentLoadedEventStart,firstByte:entry.responseStart-entry.requestStart}})});observer.observe({entryTypes:['navigation']});this.observers.push(observer)}catch(e){console.warn('Navigation timing not supported')}}observePaint(){try{const observer=new PerformanceObserver((list)=>{const entries=list.getEntries();entries.forEach(entry=>{this.metrics[entry.name]=entry.startTime})});observer.observe({entryTypes:['paint']});this.observers.push(observer)}catch(e){console.warn('Paint timing not supported')}}observeResources(){try{const observer=new PerformanceObserver((list)=>{const entries=list.getEntries();this.metrics.resources=entries.map(entry=>({name:entry.name,duration:entry.duration,size:entry.transferSize||0}))});observer.observe({entryTypes:['resource']});this.observers.push(observer)}catch(e){console.warn('Resource timing not supported')}}getMetrics(){return{...this.metrics,memory:this.getMemoryInfo(),connection:this.getConnectionInfo()}}getMemoryInfo(){if('memory'in performance){return{used:performance.memory.usedJSHeapSize,total:performance.memory.totalJSHeapSize,limit:performance.memory.jsHeapSizeLimit}}return null}getConnectionInfo(){if('connection'in navigator){const conn=navigator.connection;return{effectiveType:conn.effectiveType,downlink:conn.downlink,rtt:conn.rtt}}return null}destroy(){this.observers.forEach(observer=>observer.disconnect());this.observers=[];this.metrics={}}}class ErrorHandler{constructor(){this.errors=[];this.maxErrors=50;this.init()}init(){window.addEventListener('error',this.handleError.bind(this));window.addEventListener('unhandledrejection',this.handlePromiseRejection.bind(this))}handleError(event){const error={type:'javascript',message:event.message,filename:event.filename,lineno:event.lineno,colno:event.colno,stack:event.error?event.error.stack:null,timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent};this.logError(error)}handlePromiseRejection(event){const error={type:'promise',message:event.reason?event.reason.toString():'Promise rejected',stack:event.reason?event.reason.stack:null,timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent};this.logError(error);event.preventDefault()}logError(error){this.errors.push(error);if(this.errors.length>this.maxErrors){this.errors.shift()}console.error('Lotus Glass Error:',error);if(window.gtag){gtag('event','exception',{description:error.message,fatal:false})}}getErrors(){return this.errors}clearErrors(){this.errors=[]}}const LotusCore={PerfUtils,DOMUtils,StorageUtils,EventBus:new EventBus(),PerformanceMonitor:new PerformanceMonitor(),ErrorHandler:new ErrorHandler(),LazyLoader:new OptimizedLazyLoader(),init(){console.log('ðŸŒ¸ Lotus Glass Core v6.0 initialized');this.EventBus.emit('core:ready',{version:'6.0',timestamp:Date.now()});if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>{this.EventBus.emit('dom:ready')})}else{this.EventBus.emit('dom:ready')}},version:'6.0'};window.LotusCore=LotusCore;if(typeof module!=='undefined'&&module.exports){module.exports=LotusCore}})(window,document);
